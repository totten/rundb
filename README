# qdb: Quick-and-dirty MariaDB master-slave deployment

## Requirements

* Run Linux or OS X on the local workstation
* Install the [nix package manager](https://nixos.org/nix/)
* Install `git`

## Download

```
git clone https://github.com/totten/qdb
cd qdb
```

## Configuration files

* `master/conf/my.cnf.tmpl`: Configuration file for master DB
* `slave/conf/my.cnf.tmpl`: Configuration file for slave DB
* `common/conf/my.cnf`: Configuration elements shared by master and slave DB

## Quick Commands

```
## Start master DB in foreground. To stop it, press Ctrl-\
nix-shell -A master --command qdb

## Start slave DB in foreground. To stop it, press Ctrl-\
nix-shell -A slave --command qdb

## Destroy all state files from master DB.
nix-shell -A master --command 'qdb clear'

## Destroy all state files from slave DB.
nix-shell -A slave --command 'qdb clear'
```

## Shell

You can open a shell running mysql commands (`mysql`, `mysqldump`, etc) on the master instance:

```
me@localhost:~/src/qdb$ nix-shell -A master
[nix-shell:~/src/qdb]$ mysql --version
mysql  Ver 15.1 Distrib 10.2.17-MariaDB, for osx10.13 (x86_64) using readline 5.1
[nix-shell:~/src/qdb]$
```

Similarly, for interacting with the slave instance:

```
me@localhost:~/src/qdb$ nix-shell -A slave
[nix-shell:~/src/qdb]$ mysql --version
mysql  Ver 15.1 Distrib 10.2.17-MariaDB, for osx10.13 (x86_64) using readline 5.1
[nix-shell:~/src/qdb]$
```

## Connection Credentials

| Instance    | IP           | Port      | Root User   | Root Password |
|-------------|--------------|-----------|-------------|---------------|
| `master`    | `127.0.0.1`  | `3330`    | `root`      |               |
| `slave`     | `127.0.0.1`  | `3331`    | `root`      |               |

This is horrifically insecure by default. It's only for internal/local development.
