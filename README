# 2db: Quick-and-dirty MariaDB master-slave deployment

## Requirements

* Run Linux or OS X on the local workstation
* Install the [nix package manager](https://nixos.org/nix/)
* Install `git`

## Download

```
git clone https://github.com/totten/2db
cd 2db
```

## Configuration files

* `master/conf/my.cnf.tmpl`: Configuration file for master DB
* `slave/conf/my.cnf.tmpl`: Configuration file for slave DB

## Quick Commands

```
## Start master DB in foreground. To stop it, press Ctrl-\
nix-shell -A master --command '2db run'

## Start slave DB in foreground. To stop it, press Ctrl-\
nix-shell -A slave --command '2db run'

## Destroy all state files from master DB.
nix-shell -A master --command '2db clear'

## Destroy all state files from slave DB.
nix-shell -A slave --command '2db clear'
```

## Shell

You can open a shell running mysql commands (`mysql`, `mysqldump`, etc) on the master instance:

```
me@localhost:~/src/2db$ nix-shell -A master
[nix-shell:~/src/2db]$ mysql --version
mysql  Ver 15.1 Distrib 10.2.17-MariaDB, for osx10.13 (x86_64) using readline 5.1
[nix-shell:~/src/2db]$
```

Similarly, for interacting with the slave instance:

```
me@localhost:~/src/2db$ nix-shell -A slave
[nix-shell:~/src/2db]$ mysql --version
mysql  Ver 15.1 Distrib 10.2.17-MariaDB, for osx10.13 (x86_64) using readline 5.1
[nix-shell:~/src/2db]$
```
